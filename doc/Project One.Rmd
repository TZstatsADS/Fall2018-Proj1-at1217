---
title: "Does marriage really enrich our happiness? Do males and females have different tastes of thier happiness?"
output:
  pdf_document: default
  html_document:
    df_print: paged
---
**Author: Amon Tokoro**
**Date: 09/17/2018**

As the title, I will tuckle to questions, "What do people feel happy from?" and "Is there any difference between genders and marital status?".

```{r echo = FALSE, results= 'hide', warning = FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(magrittr)
library(tidyr)
library(tm)
library(SnowballC)
library(wordcloud)
library(RColorBrewer)
library(ngram)
library(qdap)
library(reshape2)
library(ggpubr)
```

```{r echo = FALSE, results= 'hide', warning = FALSE}
# Reading the file and converting it into a DataFrame

demographic <- "https://raw.githubusercontent.com/rit-public/HappyDB/master/happydb/data/demographic.csv"

clean_hm <- "https://raw.githubusercontent.com/TZstatsADS/ADS_Teaching/master/Projects_startercodes/Project1-RNotebook/output/processed_moments.csv"

sense_label <- "https://raw.githubusercontent.com/rit-public/HappyDB/master/happydb/data/senselabel.csv"

vad <- "https://raw.githubusercontent.com/rit-public/HappyDB/master/happydb/data/vad.csv"

demo <- read_csv(demographic)
clean<- read_csv(clean_hm)

demo_df <- as.data.frame(demo)
clean_df <- as.data.frame(clean)

demo_df['age'] <- lapply(demo_df['age'], as.numeric)
demo_df['age'] <- lapply(demo_df['age'], round)

demo_clean_df <- demo_df %>%
  
  inner_join(clean_df, by = "wid") %>%
  na.omit(demo_df$gender) 

demo_clean_df$gender[demo_clean_df$gender == "f"] <- "female"  
demo_clean_df$gender[demo_clean_df$gender == "m"] <- "male"  
demo_clean_df$gender[demo_clean_df$gender == "o"] <- "not rather say" 

demo_clean_df['wordcount'] <- sapply(demo_clean_df$text, wordcount)

female_df <- demo_clean_df %>%
  filter(gender == "female")


male_df <- demo_clean_df %>%
  filter(gender == "male")


married_f_df <- demo_clean_df %>%
  filter(marital == "married") %>%
  filter(gender == "female")%>%
  filter(wordcount <= 10)
  
married_m_df <- demo_clean_df %>%
  filter(marital == "married") %>%
  filter(gender == "male") %>%
  filter(wordcount <= 10)

single_f_df <- demo_clean_df %>%
  filter(marital == "single") %>%
  filter(gender == "female") %>%
   filter(wordcount <= 10)

single_m_df <- demo_clean_df %>%
  filter(marital == "single") %>%
  filter(gender == "male") %>%
   filter(wordcount <= 10)

marital_df <- demo_clean_df %>%
  filter(marital == c("single", "married"))



```

The first step is to check how age and gender are distributed. As we can observe, predictably, the distribution for age is right skewed. Up to sampled individuals at age 40, the proportion of males are relatively higher than that of females. 
When it comes to the marital status. We can see that females tend to get married later than males. This result may be caused that females embrace their jobs, and an increase in female-friendly workplaces allows them to guarantee to return thier job after matanity leaves. 



```{r echo = FALSE, warning=FALSE, warning = FALSE}
#Histogram for gender
ggplot(demo_clean_df, aes(x = age, fill = gender, color = gender)) + geom_histogram(alpha = 0.2, bins = 30, xlim = c(15,80)) + labs(title = "Age Frequency Categorized by Gender", x = "Age", y = "Frequency") + scale_x_continuous(limits = c(0, 90)) 

#Histogram for marital status
ggplot(marital_df , aes(x = age, fill = marital, color = marital)) + geom_histogram(alpha = 0.3, bins = 50, xlim = c(15,80)) + facet_grid(marital ~.) + labs(title = "Age Frequency Categorized by Marital Status", y = "Frequency") + scale_x_continuous(limits = c(0, 90)) 
```

Before digging into what makes them happy, I established an assumption that things related to family and their free time would make married females would feel happy. On the other hand, things related to their job and money would make entire males happy. Let's see...


**Single Females**

  There are some surprising results generated by the word cloud. The first fact is that arguably for single females, they feel happier with things associated with friends than those related to their boyfriend. Perhaps, we need to know whether samples have a boyfriend or not to make it clear. Or they feel preseant to look for one. 
  
  
```{r echo = FALSE, warning = FALSE}
#Word Cloud for single females
single_f_docs <- Corpus(VectorSource(single_f_df$text))
single_f_dtm <- TermDocumentMatrix(single_f_docs)
single_f_m <- as.matrix(single_f_dtm)
single_f_v <- sort(rowSums(single_f_m),decreasing=TRUE)
single_f_d <- data.frame(word = names(single_f_v),single=single_f_v)


set.seed(1234)

wordcloud(words = single_f_d$word, freq = single_f_d$single, min.freq = 1,
          max.words= 100,scale=c(4,.3), random.order=FALSE, rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))





```


**Single Males**

Similar to single females, males also spend happy moments with friends rather than their girlfriend. It seems that males feel joyful with something active or achievements such as "won," "game," and "job" etc.


```{r echo = FALSE, warning = FALSE}
#Word Cloud for single males
single_m_docs <- Corpus(VectorSource(single_m_df$text))
single_m_dtm <- TermDocumentMatrix(single_m_docs)
single_m_m <- as.matrix(single_m_dtm)
single_m_v <- sort(rowSums(single_m_m),decreasing=TRUE)
single_m_d <- data.frame(word = names(single_m_v),single=single_m_v)


set.seed(1234)

wordcloud(words = single_m_d$word, freq = single_m_d$single, min.freq = 1,
          max.words=100,scale=c(4,.3), random.order=FALSE, rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))
```

```{r echo = FALSE, warning = FALSE}
attach(single_f_d)
single_f_top10 <- single_f_d[order(-single),]
single_f_top10 <- single_f_top10[1:10,]

attach(single_m_d)
single_m_top10 <- single_m_d[order(-single),]
single_m_top10 <- single_m_top10[1:10,]
```


**Married Females**

On contrary to single individuals, married females focus on more family and time with their family members. It seems that they show their dedication to thier family rather than themselves. Money is less important for their happiness once they have their own family.


```{r echo = FALSE, warning = FALSE}
#Word Cloud for married females
married_f_docs <- Corpus(VectorSource(married_f_df$text))
married_f_dtm <- TermDocumentMatrix(married_f_docs)
married_f_m <- as.matrix(married_f_dtm)
married_f_v <- sort(rowSums(married_f_m),decreasing=TRUE)
married_f_d <- data.frame(word = names(married_f_v),freq=married_f_v)


set.seed(1234)
wordcloud(words = married_f_d$word, freq = married_f_d$freq, min.freq = 1,
          max.words=100,scale=c(4,.3), random.order=FALSE, rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))

```


**Married Males**

Similarly, as we can see, family times give married males happy moments. As a responsible role in a family, they also feel great when they "received," 
"completed," or "finished" something related to their job.


```{r echo = FALSE, warning = FALSE}
#Word Cloud for married males
married_m_docs <- Corpus(VectorSource(married_m_df$text))
married_m_dtm <- TermDocumentMatrix(married_m_docs)
married_m_m <- as.matrix(married_m_dtm)
married_m_v <- sort(rowSums(married_m_m),decreasing=TRUE)
married_m_d <- data.frame(word = names(married_m_v),freq=married_m_v)


set.seed(1234)
wordcloud(words = married_m_d$word, freq = married_m_d$freq, min.freq = 1,
          max.words=100,scale=c(4,.3), random.order=FALSE, rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))
```

```{r echo = FALSE, results = 'hide', warning = FALSE}
attach(married_f_d)
married_f_top10 <- married_f_d[order(-freq),]
married_f_top10 <- married_f_top10[1:10,]

attach(married_m_d)
married_m_top10 <- married_m_d[order(-freq),]
married_m_top10 <- married_m_top10[1:10,]

```


Now, let's take a look at top 10 frequent words. When compared to single females, ,as we can see in the graph, single males tend to prefer to do individual activities. Also, standardizing the scale in terms of sample sizes of single males and single females, we can see that the number of "friend," "time," "day," and "boyfriend/girlfriend" is proportionally equal and there is not a huge different between this categories. On the other hand, married male relatively feel happy with their wife rather than married females regarding the proportion of the sample size.


```{r echo = FALSE, warning = FALSE}
ggplot(married_f_top10, aes(x = word, y = freq, color = word, fill = word)) + geom_bar(stat = "identity") + geom_text(aes(label = freq), vjust = 1.5, color = "black", size = 5) + labs(title = "Top 10 Frequent Words for Married Females", x = "Word", y = "Frequency")

ggplot(married_m_top10, aes(x = word, y = freq, color = word, fill = word)) + geom_bar(stat = "identity") + geom_text(aes(label = freq), vjust = 1.5, color = "black", size = 5) + labs(title = "Top 10 Frequent Words for Married Males", x = "Word", y = "Frequency")

ggplot(single_f_top10, aes(x = word, y = single, color = word, fill = word)) + geom_bar(stat = "identity") + geom_text(aes(label = single), vjust = 1.5, color = "black", size = 5) + labs(title = "Top 10 Frequent Words for Single Females", x = "Word", y = "Frequency")

ggplot(single_m_top10, aes(x = word, y = single, color = word, fill = word)) + geom_bar(stat = "identity") + geom_text(aes(label = single), vjust = 1.5, color = "black", size = 5) + labs(title = "Top 10 Frequent Words for Single Males", x = "Word", y = "Frequency")



```


Lastly, we will take a look at how word counts affect people's emotion as well as analyze differences among categorized groups. Interestingly, between single-status people, most of categories except for "affection" and "leisure" stay exactly the same mean and variance. However, the result indicates that single females take into account affection and nature are top two moments that make them happy. Whereas, for single males, each variance of the components is wider than that of single females. The significant difference is a higher mean of the "leisure" category. Comparing married-status people, we can see more dynamic difference between two genders. 


```{r echo= FALSE, warning = FALSE}

ggplot(married_f_df, aes(x = predicted_category, y = wordcount, color = predicted_category)) + geom_boxplot(ylim = c(0, 50)) + ggtitle("Correlation of Predicted category and word counts for married females") + scale_x_discrete(labels = abbreviate)


ggplot(married_m_df, aes(x = predicted_category, y = wordcount, color = predicted_category)) + geom_boxplot(ylim = c(0, 50)) + ggtitle("Correlation of Predicted category and word counts for married males") + scale_x_discrete(labels = abbreviate)

ggplot(single_f_df, aes(x = predicted_category, y = wordcount, color = predicted_category)) + geom_boxplot(ylim = c(0, 50)) + ggtitle("Correlation of Predicted category and word counts for single females") + scale_x_discrete(labels = abbreviate)

ggplot(single_m_df, aes(x = predicted_category, y = wordcount, color = predicted_category)) + geom_boxplot(ylim = c(0, 50)) + ggtitle("Correlation of Predicted category and word counts for single males") + scale_x_discrete(labels = abbreviate)

```


**Summary**

Overall, we have seen and interpreted patterns and tendency through visualizations.
Interesting facts are as follows:

I) Even though people get married, their friends are their second highest happiness providers(it is actually higher than their family members except for their partner).

II) Overall common tendency: friends and some amount of their own times make people happy.

III) Common tendency between marital status: happiness providers are shifted from ones for themselves to things family-oriented. However, the number of texts becomes less and less once people get married because they are deprived of their own free times and they need to take care of their children. Also, a marriage does not mean that affection- and bonding-related texts are increased. No matter what marital status and gender people are, it does not affect the word count describing achievements.

**Conclusion**

We have not seen marriage itself enrichs people's happiness. However, we have seen that it definitely shifts types of happiness provides.Essentially, there is no distinctive difference between genders, especially for top five happiness providers. 


